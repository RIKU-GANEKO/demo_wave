# Demo Wave

## サービス内容
デモ活動の敷居を下げるためのアプリを開発したい.

## 簡単な内容　（アイディア含む）
- ユーザーはデモの予定を立ち上げられる
- ユーザーはデモの日程を確認でき参加意思を表明できる
- ユーザーはクラウドファンディング的な感じでデモ団体へ寄付ができる
- 寄付された金額はデモ参加者が受け取れる
- デモ参加の定義はデモの場所に居たかどうか. 参加時間に応じて分配.
- ランキングがある(デモ参加が多い, 寄付金が多い, デモ主催の数が多い等)
- SNS連携機能がある(X, instagramなどで参加を呼びかける)
- ユーザー同士のフォロー機能. 相互フォローでお互いの「参加したデモ」が見れる
- デモで用いる道具(ex. スピーカーの数)を確認できる
- デモのLive映像が見れる
- 関心のあるデモ内容(ex. 環境問題, 人権問題)を投票できる機能がある
- sendgrid使って、ユーザー登録や支援金を送った場合などにメール送信
- 支援金を送った人に向けたレポートが見れたら嬉しい
- 韓国のデモ活動のようにエンタメ要素を取り入れる. ペンライトをふるライブ的な

## 技術
- 言語: Java(Spring)
- DB: MySQL
- デフォルトデータはmigrationツールとしてMyBatisで挿入
- サーバー: AWS予定
- CI/CD: Jenkins
- 決済系: Stripe
- Webアプリで作成(将来的にモバイルアプリも)

## 画面構成
- デモ活動予定一覧画面
  - 主催者, 場所, 時間, 内容 が見れる
  - 内容や開催時期場所,でフィルタリングできる
- 各デモ活動予定詳細画面
  - 参加ボタンがある
  - 資金提供ボタンがある
  - コメントボタンがある
- デモ活動新規作成画面(確認, 完了画面)
  - 開催場所, 時間を明確に指定
  - googlemap埋め込み(DBで緯度経度管理)
- 支援金送信に関わる画面
- MyPage画面
  - プロフィールが見れる
  - 過去参加したデモの内容(デモ詳細画面)に飛べる
  - 過去送金した支援金の内訳が見れる
  - フォロー/被フォローのユーザーが見れる(Instagram的な)
  - 個人ユーザーに向けても支援金が送れる
- ランキング画面
  - デモ参加数のランキングが見れる
  - デモ参加時間のランキングが見れる
  - デモ支援金総額のランキングが見れる(社会通念上良くないかもなので検討)


### 支援金送金ロジック流れ
支援金がStripeで支払われる。
Webhookで支援金データを取得。
デモID(information_id), 支援者user_idをメタデータとしてリクエストに付与
支援金データをデータベースに保存。
支援金をデモ参加者に分配。
各デモ参加者の銀行口座に送金。
stripe connectや銀行API(楽天銀行APIなど)といった選択肢がある
stripe connectは手数料高い？

疑問
stripeで送った支援金はどこにいった？
-> おそらくstripe(我如古のアカウント)にバランス(預金)という扱いで(入金された金額-手数料)が振り込まれる。なので我如古はその振り込まれたお金をデモ参加者に配る必要がある.このロジックは要検討.
デモ参加者への送金は銀行振り込みよりPaypay送金の方が良さそう。(手数料低)
なので一旦我如古の銀行口座への振り込み->各デモ参加者へのPaypayへ送金という流れになりそう。

実装メモ
stripeの機能を試すときは事前にstripeからのリクエストを転送する必要がある
```
rn-618@RN-871 ~ % stripe listen --forward-to http://localhost:8082/demo_wave/payment/webhook/stripe
```
