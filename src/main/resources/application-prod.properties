# ========================================
# Railway Production Configuration
# Updated: 2025-11-18
# ========================================

# Application Settings
spring.application.name=demo_wave
server.port=${PORT:8080}

# Memory Optimization - Tomcat Thread Pool
server.tomcat.threads.max=50
server.tomcat.threads.min-spare=5
server.tomcat.accept-count=50

# Lazy Initialization (reduces startup memory)
spring.main.lazy-initialization=true

# Character Encoding
server.servlet.encoding.charset=UTF-8
server.servlet.encoding.enabled=true
server.servlet.encoding.force=true
spring.http.encoding.charset=UTF-8
spring.http.encoding.enabled=true
spring.http.encoding.force=true

# Database (PostgreSQL/Supabase - Connection Pooling)
spring.datasource.url=${DATABASE_URL}
spring.datasource.username=${DB_USERNAME}
spring.datasource.password=${DB_PASSWORD}
spring.jpa.database-platform=org.hibernate.dialect.PostgreSQLDialect

# HikariCP Settings (Supabase Free Tier: max 5 connections)
spring.datasource.hikari.maximum-pool-size=3
spring.datasource.hikari.minimum-idle=1
spring.datasource.hikari.connection-timeout=30000
spring.datasource.hikari.idle-timeout=600000
spring.datasource.hikari.max-lifetime=1800000
spring.datasource.hikari.pool-name=DemoWaveHikariPool

# JPA Settings (Production)
spring.jpa.show-sql=false
spring.sql.init.mode=never
spring.jpa.hibernate.ddl-auto=none
spring.jpa.properties.hibernate.jdbc.batch_size=20
spring.jpa.properties.hibernate.order_inserts=true
spring.jpa.properties.hibernate.order_updates=true

# Template Engine (Thymeleaf)
spring.thymeleaf.cache=true
spring.thymeleaf.encoding=UTF-8
spring.thymeleaf.mode=HTML

# Application Settings
spring.data.web.pageable.default-page-size=30
other.app.base-url=${APP_BASE_URL:https://demo-wave.com}
other.app.page-records-limit=30

# File Upload
spring.servlet.multipart.max-file-size=5MB
spring.servlet.multipart.max-request-size=5MB

# API Keys (from Environment Variables)
stripe.key.secret=${STRIPE_SECRET_KEY}
stripe.webhook.secret=${STRIPE_WEBHOOK_SECRET}

# Supabase
supabase.enabled=true
supabase.url=${SUPABASE_URL}
supabase.anon.key=${SUPABASE_ANON_KEY}
supabase.service.role.key=${SUPABASE_SERVICE_ROLE_KEY}
supabase.jwt.secret=${SUPABASE_JWT_SECRET}

# Google OAuth & Maps
google.oauth.client.id=${GOOGLE_OAUTH_CLIENT_ID}
google.oauth.client.secret=${GOOGLE_OAUTH_CLIENT_SECRET}
google.maps.api.key=${GOOGLE_MAPS_API_KEY}

# AWS SES
aws.access.key.id=${AWS_ACCESS_KEY_ID}
aws.secret.access.key=${AWS_SECRET_ACCESS_KEY}
aws.region=${AWS_REGION:ap-northeast-1}
aws.ses.from.email=${AWS_SES_FROM_EMAIL}

# Logging (Production)
logging.level.org.springframework=INFO
logging.level.product.demo_wave=INFO
logging.level.com.zaxxer.hikari=WARN
logging.charset.console=UTF-8
logging.charset.file=UTF-8

# Security Settings
server.error.include-message=never
server.error.include-binding-errors=never
server.error.include-stacktrace=never